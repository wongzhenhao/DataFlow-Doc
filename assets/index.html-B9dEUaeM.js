import{_ as i,c as a,b as n,o as l}from"./app-GpZKBnvo.js";const e={};function h(k,s){return l(),a("div",null,s[0]||(s[0]=[n(`<h2 id="_1-æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#_1-æ¦‚è¿°"><span>1. æ¦‚è¿°</span></a></h2><p>çŸ¥è¯†åº“æ¸…æ´—æµæ°´çº¿çš„æ ¸å¿ƒç›®æ ‡æ˜¯å¯¹äºç”¨æˆ·æä¾›çš„æ ¼å¼å¼‚æ„ã€ä¿¡æ¯å™ªå£°é«˜çš„åŸå§‹æ–‡æ¡£ï¼Œæä¾›<strong>ç«¯åˆ°ç«¯çš„</strong>ä¿¡æ¯æå–ã€è§„èŒƒåŒ–ä»¥åŠå¿…è¦å…ƒä¿¡æ¯çš„ç”ŸæˆæœåŠ¡ã€‚è¿™æ ·æå–å‡ºçš„æ•°æ®å¯ä»¥ç›´æ¥ç”¨äºRAGã€é¢„è®­ç»ƒï¼Œä»¥åŠä¼—å¤šå¤§æ¨¡å‹ä¸‹æ¸¸ä»»åŠ¡ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæµæ°´çº¿é€šè¿‡æ»‘åŠ¨çª—å£çš„æ–¹å¼ï¼ŒæŠŠæ¸…æ´—å¥½çš„çŸ¥è¯†è½¬åŒ–æˆä¸€ç»„Multi-Hop QAã€‚æ ¹æ®<a href="https://github.com/eth-medical-ai-lab/MIRIAD" target="_blank" rel="noopener noreferrer">MIRIAD</a>çš„å®éªŒï¼Œè¿™ç§QAæ ¼å¼çš„çŸ¥è¯†æ›´æœ‰åˆ©äºRAGå‡†ç¡®æ¨ç†ã€‚</p><p>çŸ¥è¯†åº“æ¸…æ´—æ”¯æŒçš„æ–‡ä»¶æ ¼å¼åŒ…æ‹¬<strong>PDF, Markdown, HTMLä»¥åŠçˆ¬å–URL</strong>å¯¹åº”çš„ç½‘é¡µä¿¡æ¯ã€‚</p><p>æµæ°´çº¿çš„ä¸»è¦æµç¨‹åŒ…æ‹¬ï¼š</p><ol><li>ä¿¡æ¯æå–ï¼šå€ŸåŠ©<a href="https://github.com/opendatalab/MinerU" target="_blank" rel="noopener noreferrer">MinerU</a>, <a href="https://github.com/adbar/trafilatura" target="_blank" rel="noopener noreferrer">trafilatura</a>ç­‰å·¥å…·ä»åŸå§‹æ–‡æ¡£ä¸­æå–æ–‡æœ¬ä¿¡æ¯ã€‚</li><li>æ–‡æœ¬åˆ†æ®µï¼šå€ŸåŠ©<a href="https://github.com/chonkie-inc/chonkie" target="_blank" rel="noopener noreferrer">chonkie</a>å°†æ–‡æœ¬åˆ‡åˆ†æˆç‰‡æ®µï¼Œæ”¯æŒé€šè¿‡Tokenï¼Œå­—ç¬¦ï¼Œå¥å­ç­‰åˆ†æ®µæ–¹å¼ã€‚</li><li>çŸ¥è¯†æ¸…æ´—ï¼šä»å†—ä½™æ ‡ç­¾ï¼Œæ ¼å¼é”™è¯¯ï¼Œå±è”½éšç§ä¿¡æ¯å’Œè¿è§„ä¿¡æ¯ç­‰è§’åº¦å¯¹åŸå§‹æ–‡æœ¬ä¿¡æ¯è¿›è¡Œæ¸…æ´—ï¼Œä½¿æ–‡æœ¬ä¿¡æ¯æ›´åŠ æ¸…æ´å¯ç”¨ã€‚</li><li>QAæ„å»ºï¼šåˆ©ç”¨é•¿åº¦ä¸ºä¸‰ä¸ªå¥å­çš„æ»‘åŠ¨çª—å£ï¼Œå°†æ¸…æ´—å¥½çš„çŸ¥è¯†åº“è½¬å†™æˆä¸€ç³»åˆ—éœ€è¦å¤šæ­¥æ¨ç†çš„QAï¼Œæ›´æœ‰åˆ©äºRAGå‡†ç¡®æ¨ç†ã€‚</li></ol><h2 id="_2-æµæ°´çº¿è®¾è®¡" tabindex="-1"><a class="header-anchor" href="#_2-æµæ°´çº¿è®¾è®¡"><span>2. æµæ°´çº¿è®¾è®¡</span></a></h2><h3 id="_1-ä¿¡æ¯æå–" tabindex="-1"><a class="header-anchor" href="#_1-ä¿¡æ¯æå–"><span>1. ä¿¡æ¯æå–</span></a></h3><p>æµæ°´çº¿ç¬¬ä¸€æ­¥æ˜¯é€šè¿‡FileOrURLToMarkdownConverterBatchä»ç”¨æˆ·åŸå§‹æ–‡æ¡£æˆ–URLä¸­æå–æ–‡æœ¬çŸ¥è¯†ã€‚æ­¤æ­¥éª¤è‡³å…³é‡è¦ï¼Œå®ƒå°†å„ç§æ ¼å¼çš„åŸå§‹æ–‡æ¡£æå–æˆç»Ÿä¸€çš„markdownæ ¼å¼æ–‡æœ¬ï¼Œæ–¹ä¾¿åç»­æ¸…æ´—æ­¥éª¤è¿›è¡Œã€‚</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">conda</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> create</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -n</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dataflow</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> python=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">3.10</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">conda</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> activate</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dataflow</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> clone</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> https://github.com/OpenDCAI/DataFlow.git</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> DataFlow</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pip</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -e</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> .</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pip</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">mineru[all]</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ¬ç³»ç»Ÿä¸­PDFæ–‡ä»¶çš„æå–åŸºäº<a href="https://github.com/opendatalab/MinerU" target="_blank" rel="noopener noreferrer">MinerU</a>,éœ€è¿›è¡Œé¢å¤–é…ç½®ï¼Œç”¨æˆ·å¯é€šè¿‡å¦‚ä¸‹æ–¹å¼é…ç½®ã€‚</p><blockquote><h4 id="ä½¿ç”¨æœ¬åœ°æ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æœ¬åœ°æ¨¡å‹"><span>ä½¿ç”¨æœ¬åœ°æ¨¡å‹</span></a></h4><p>ä¸ºäº†åœ¨æœ¬åœ°è¿è¡Œ <code>MinerU</code> æ¨¡å‹ï¼Œæ‚¨éœ€è¦å…ˆå°†å®ƒä»¬ä¸‹è½½åˆ°æœ¬åœ°å­˜å‚¨ã€‚<code>MinerU</code> æä¾›äº†ä¸€ä¸ªäº¤äº’å¼å‘½ä»¤è¡Œå·¥å…·æ¥ç®€åŒ–æ­¤è¿‡ç¨‹ã€‚</p><h4 id="_1-ä¸‹è½½å·¥å…·æŒ‡å¼•" tabindex="-1"><a class="header-anchor" href="#_1-ä¸‹è½½å·¥å…·æŒ‡å¼•"><span>1. ä¸‹è½½å·¥å…·æŒ‡å¼•ï¼š</span></a></h4><p>æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹æ¨¡å‹ä¸‹è½½å·¥å…·çš„å¸®åŠ©ä¿¡æ¯ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mineru-models-download</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --help</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_2-å¯åŠ¨æ¨¡å‹ä¸‹è½½" tabindex="-1"><a class="header-anchor" href="#_2-å¯åŠ¨æ¨¡å‹ä¸‹è½½"><span>2. å¯åŠ¨æ¨¡å‹ä¸‹è½½ï¼š</span></a></h4><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¼€å§‹ä¸‹è½½è¿‡ç¨‹ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mineru-models-download</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>åœ¨ä¸‹è½½è¿‡ç¨‹ä¸­ï¼Œæ‚¨å°†çœ‹åˆ°ä»¥ä¸‹äº¤äº’å¼æç¤ºï¼š</p><ul><li><p><strong>é€‰æ‹©æ¨¡å‹ä¸‹è½½æº</strong>ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Please</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> select</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> the</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> model</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> download</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> source:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (huggingface, </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">modelscope</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">huggingface</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">:</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><em>å»ºè®®æ‚¨é€‰æ‹© <code>modelscope</code> ä½œä¸ºä¸‹è½½æºï¼Œä»¥è·å–æ›´ä¼˜çš„ä¸‹è½½ä½“éªŒã€‚</em></p></li><li><p><strong>é€‰æ‹©<code>MinerU</code> ç‰ˆæœ¬</strong>ï¼š</p><p><code>MinerU1</code>ä¸º<code>pipeline</code>å½¢å¼è§£æï¼Œé€Ÿåº¦è¾ƒæ…¢ï¼Œæ˜¾å­˜è¦æ±‚ä½ã€‚ <code>MinerU2.5</code>ä¸º<code>vlm</code>å½¢å¼è§£æï¼Œé€Ÿåº¦è¾ƒå¿«ï¼Œæ˜¾å­˜è¦æ±‚é«˜ã€‚ç”¨æˆ·å¯ä»¥æŒ‰éœ€è‡ªç”±é€‰æ‹©æƒ³ä½¿ç”¨çš„MinerUè§£æç‰ˆæœ¬ç„¶åä¸‹è½½åˆ°æœ¬åœ°ã€‚</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Please</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> select</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> the</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> model</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> type</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> to</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> download:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (pipeline, </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">vlm,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> all</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">all</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">:</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><em>å»ºè®®æ‚¨é€‰æ‹© <code>vlm</code> (MinerU2) ç‰ˆæœ¬ï¼Œå› ä¸ºå®ƒæä¾›äº†æ›´å¿«çš„è§£æé€Ÿåº¦ã€‚å¦‚æœæ‚¨å¯¹æ˜¾å­˜æœ‰ä¸¥æ ¼è¦æ±‚æˆ–åå¥½ä¼ ç»Ÿæµæ°´çº¿å¤„ç†ï¼Œå¯ä»¥é€‰æ‹© <code>pipeline</code> (MinerU1)ã€‚æ‚¨ä¹Ÿå¯ä»¥é€‰æ‹© <code>all</code> æ¥ä¸‹è½½æ‰€æœ‰å¯ç”¨ç‰ˆæœ¬ã€‚</em></p></li></ul><h4 id="_3-æ¨¡å‹è·¯å¾„é…ç½®" tabindex="-1"><a class="header-anchor" href="#_3-æ¨¡å‹è·¯å¾„é…ç½®"><span>3. æ¨¡å‹è·¯å¾„é…ç½®</span></a></h4><p><code>mineru.json</code> é…ç½®æ–‡ä»¶ä¼šåœ¨æ‚¨é¦–æ¬¡ä½¿ç”¨ <code>mineru-models-download</code> å‘½ä»¤æ—¶è‡ªåŠ¨ç”Ÿæˆã€‚æ¨¡å‹ä¸‹è½½å®Œæˆåï¼Œå…¶æœ¬åœ°è·¯å¾„å°†ä¼šåœ¨å½“å‰ç»ˆç«¯çª—å£æ˜¾ç¤ºï¼Œå¹¶è‡ªåŠ¨å†™å…¥æ‚¨ç”¨æˆ·ç›®å½•ä¸‹çš„ <code>mineru.json</code> æ–‡ä»¶ä¸­ï¼Œæ–¹ä¾¿åç»­ä½¿ç”¨ã€‚</p><h4 id="_4-mineruç¯å¢ƒéªŒè¯" tabindex="-1"><a class="header-anchor" href="#_4-mineruç¯å¢ƒéªŒè¯"><span>4. MinerUç¯å¢ƒéªŒè¯</span></a></h4><p>æœ€ç®€å•çš„å‘½ä»¤è¡Œè°ƒç”¨æ–¹å¼æ¥è¿›è¡Œç¯å¢ƒéªŒè¯:</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mineru</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -p</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">input_pat</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">h</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -o</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">output_pat</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">h</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -b</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">MinerU_Backen</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">d</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --source</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> local</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>&lt;input_path&gt;</code>ï¼šæœ¬åœ° PDF/å›¾ç‰‡æ–‡ä»¶æˆ–ç›®å½•ï¼ˆ<code>./demo.pdf</code>æˆ–<code>./image_dir</code>ï¼‰</li><li><code>&lt;output_path&gt;</code>ï¼šè¾“å‡ºç›®å½•</li><li><code>&lt;mineru_backend&gt;</code>ï¼šMinerU ç‰ˆæœ¬çš„é€‰æ‹©æ¥å£ï¼Œä½¿ç”¨<code>MinerU2.5</code>ï¼Œè¯·å°† <code>MinerU_Backend</code> å‚æ•°è®¾ç½®ä¸º <code>&quot;vlm-vllm-engine&quot;</code>æˆ–<code>&quot;vlm-transformers&quot;</code>æˆ–<code>&quot;vlm-http-client&quot;</code>ï¼›ä½¿ç”¨ <code>MinerU1</code>ï¼šè¯·å°† <code>MinerU_Backend</code> å‚æ•°è®¾ç½®ä¸º <code>&quot;pipeline&quot;</code>ã€‚</li></ul><h4 id="_5-å·¥å…·ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#_5-å·¥å…·ä½¿ç”¨"><span>5. å·¥å…·ä½¿ç”¨</span></a></h4><p><code>FileOrURLToMarkdownConverter</code> ç®—å­æä¾›äº† MinerU ç‰ˆæœ¬çš„é€‰æ‹©æ¥å£ï¼Œå…è®¸ç”¨æˆ·æ ¹æ®éœ€æ±‚é€‰æ‹©åˆé€‚çš„åç«¯å¼•æ“ã€‚</p><ul><li>å¦‚æœç”¨æˆ·ä½¿ç”¨ <code>MinerU1</code>ï¼šè¯·å°† <code>MinerU_Backend</code> å‚æ•°è®¾ç½®ä¸º <code>&quot;pipeline&quot;</code>ã€‚è¿™å°†å¯ç”¨ä¼ ç»Ÿçš„æµæ°´çº¿å¤„ç†æ–¹å¼ã€‚</li><li>å¦‚æœç”¨æˆ·ä½¿ç”¨ <code>MinerU2.5</code> <strong>(é»˜è®¤æ¨è)</strong>ï¼šè¯·å°† <code>MinerU_Backend</code> å‚æ•°è®¾ç½®ä¸º <code>&quot;vlm-vllm-engine&quot;</code>æˆ–<code>&quot;vlm-transformers&quot;</code>æˆ–<code>&quot;vlm-http-client&quot;</code>ã€‚è¿™å°†å¯ç”¨åŸºäºå¤šæ¨¡æ€è¯­è¨€æ¨¡å‹çš„æ–°å¼•æ“ã€‚</li></ul><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">knowledge_cleaning_step1 </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> FileOrURLToMarkdownConverter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">   intermediate_dir</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../example_data/KBCleaningPipeline/raw/</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">   lang</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">en</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">   mineru_backend</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">vlm-sglang-engine</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">   raw_file</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> raw_file</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ğŸŒŸ<strong>æ›´å¤šè¯¦æƒ…</strong>ï¼šæœ‰å…³ MinerU çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è€ƒå…¶ GitHub ä»“åº“ï¼š<a href="https://github.com/opendatalab/MinerU" target="_blank" rel="noopener noreferrer">MinerUå®˜æ–¹æ–‡æ¡£</a>ã€‚</p></blockquote><p><strong>è¾“å…¥</strong>ï¼šåŸå§‹æ–‡æ¡£æ–‡ä»¶æˆ–URLï¼ˆä½¿ç”¨MinerU2ï¼‰ <strong>è¾“å‡º</strong>ï¼šæå–åçš„markdownæ–‡æœ¬</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">knowledge_cleaning_step1 </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> FileOrURLToMarkdownConverterBatch</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    intermediate_dir</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../example_data/KBCleaningPipeline/raw/</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    lang</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">en</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    mineru_backend</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">vlm-vllm-engine</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">knowledge_cleaning_step1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">step</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(),</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # input_key=,</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # output_key=,</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-æ–‡æœ¬åˆ†å—" tabindex="-1"><a class="header-anchor" href="#_2-æ–‡æœ¬åˆ†å—"><span>2. æ–‡æœ¬åˆ†å—</span></a></h3><p>æ–‡æ¡£è¢«æå–ä¹‹åï¼Œæ–‡æœ¬åˆ†å—(KBCChunkGenerator)æ­¥éª¤å°†æå–ä¸­çš„é•¿æ–‡æœ¬åˆ‡åˆ†æˆå—ï¼Œç³»ç»Ÿæ”¯æŒé€šè¿‡token, character, sentence, semanticç»´åº¦è¿›è¡Œåˆ†å—ã€‚</p><p><strong>è¾“å…¥</strong>ï¼šæå–åçš„Markdownæ–‡æœ¬ <strong>è¾“å‡º</strong>ï¼šåˆ†å—åçš„jsonæ–‡ä»¶</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">text_splitter </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> KBCChunkGenerator</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    split_method</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">token</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    chunk_size</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">512</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    tokenizer_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Qwen/Qwen2.5-7B-Instruct</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">text_splitter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">step</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(),</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    input_file</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">extracted</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    output_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">raw_content</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-çŸ¥è¯†æ¸…æ´—" tabindex="-1"><a class="header-anchor" href="#_3-çŸ¥è¯†æ¸…æ´—"><span>3. çŸ¥è¯†æ¸…æ´—</span></a></h3><p>æ–‡æœ¬è¢«åˆ‡å—ä¹‹åï¼ŒçŸ¥è¯†æ¸…æ´—(KBCTextCleaner)ä¸“é—¨ç”¨äºå¯¹RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰ç³»ç»Ÿä¸­çš„åŸå§‹çŸ¥è¯†å†…å®¹è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ã€‚è¯¥è¿‡ç¨‹é€šè¿‡å¤§è¯­è¨€æ¨¡å‹æ¥å£ï¼Œå®ç°å¯¹éç»“æ„åŒ–çŸ¥è¯†çš„æ™ºèƒ½æ¸…æ´—å’Œæ ¼å¼åŒ–ï¼Œæå‡çŸ¥è¯†åº“çš„å‡†ç¡®æ€§å’Œå¯è¯»æ€§ã€‚</p><p><strong>è¾“å…¥</strong>ï¼šåˆ†å—åçš„jsonæ–‡ä»¶ <strong>è¾“å‡º</strong>ï¼šæ¸…æ´—åçš„jsonæ–‡ä»¶</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">knowledge_cleaner </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> KBCTextCleaner</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    llm_serving</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">api_llm_serving</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    lang</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">en</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">knowledge_cleaner</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">  storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">step</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(),</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">  input_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">raw_content</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">  output_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">cleaned</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-qaç”Ÿæˆ" tabindex="-1"><a class="header-anchor" href="#_4-qaç”Ÿæˆ"><span>4. QAç”Ÿæˆ</span></a></h3><p>çŸ¥è¯†è¢«æ¸…æ´—ä¹‹åï¼Œå¤šè·³QAåˆæˆ(Text2MultiHopQAGenerator)ä¸“é—¨ç”¨äºä»æ–‡æœ¬æ•°æ®ä¸­è‡ªåŠ¨ç”Ÿæˆéœ€è¦å¤šæ­¥æ¨ç†çš„é—®é¢˜-ç­”æ¡ˆå¯¹ã€‚è¯¥è¿‡ç¨‹é€šè¿‡å¤§è¯­è¨€æ¨¡å‹æ¥å£ï¼Œå®ç°å¯¹æ–‡æœ¬çš„æ™ºèƒ½åˆ†æå’Œå¤æ‚é—®é¢˜æ„å»ºï¼Œé€‚ç”¨äºæ„å»ºé«˜è´¨é‡çš„å¤šè·³é—®ç­”æ•°æ®é›†ã€‚æ ¹æ®<a href="https://github.com/eth-medical-ai-lab/MIRIAD" target="_blank" rel="noopener noreferrer">MIRIAD</a>çš„å®éªŒï¼Œè¿™ç§QAæ ¼å¼çš„çŸ¥è¯†æ›´æœ‰åˆ©äºRAGå‡†ç¡®æ¨ç†ã€‚</p><p><strong>è¾“å…¥</strong>ï¼šjsonæ ¼å¼çš„æ™®é€šæ–‡æœ¬</p><p><strong>è¾“å‡º</strong>ï¼šé’ˆå¯¹æ¯ä¸€æ¡æ–‡æœ¬åˆæˆä¸€ç»„å¤šè·³é—®ç­” è¾“å‡ºjsonæ ¼å¼</p><p><strong>ä½¿ç”¨ç¤ºä¾‹</strong>ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">knowledge_cleaning_step4 </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Text2MultiHopQAGenerator</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    llm_serving</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">llm_serving</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    lang</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">en</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    num_q</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 5</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">knowledge_cleaning_step4</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">step</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(),</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # input_key=,</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # output_key=,</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-è¿è¡Œç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#_3-è¿è¡Œç¤ºä¾‹"><span>3. è¿è¡Œç¤ºä¾‹</span></a></h2><p>ç”¨æˆ·æ‰§è¡Œä¸‹é¢çš„è„šæœ¬å¯ä»¥æ»¡è¶³ä¸åŒçš„æ•°æ®éœ€æ±‚ï¼Œæ³¨æ„gpu_pipelines, api_pipelines, cpu_pipelinesä¸‹é¢çš„è„šæœ¬åˆ†åˆ«é€‚ç”¨äºæµ‹è¯•æœºé…æœ‰GPUï¼Œç”¨æˆ·é…ç½®äº†APIä»¥åŠå…¶ä»–æƒ…å†µã€‚</p><blockquote><p><em>å…¶ä¸­åŸºç¡€ç¯å¢ƒå¯ä»¥è¿è¡Œ <code>gpu_pipelines/*_vllm.py</code> è„šæœ¬ï¼Œè¿è¡Œ <code>gpu_pipelines/*_sglang.py</code> è„šæœ¬è¦å•ç‹¬å®‰è£…sglang</em></p></blockquote><ul><li><p>å¼‚æ„çŸ¥è¯†åº“æ¸…æ´—æ„å»º</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">python</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> api_pipelines/kbcleaning_pipeline.py</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # APIç‰ˆæœ¬</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">python</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> gpu_pipelines/kbcleaning/kbcleaning_pipeline_vllm.py</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">python</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> gpu_pipelines/kbcleaningkbcleaning_pipeline_sglang.py</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="https://github.com/OpenDCAI/DataFlow/blob/main/dataflow/statics/pipelines/api_pipelines/kbcleaning_pipeline.py" target="_blank" rel="noopener noreferrer">kbcleaning_pipeline.py</a><a href="https://github.com/OpenDCAI/DataFlow/blob/main/dataflow/statics/pipelines/gpu_pipelines/kbcleaning/kbcleaning_pipeline_vllm.py" target="_blank" rel="noopener noreferrer">kbcleaning_pipeline_pdf_vllm.py</a><a href="https://github.com/OpenDCAI/DataFlow/blob/main/dataflow/statics/pipelines/gpu_pipelines/kbcleaning/kbcleaning_pipeline_sglang.py" target="_blank" rel="noopener noreferrer">kbcleaning_pipeline_pdf_sglang.py </a></p></li></ul><h2 id="_4-æµæ°´çº¿ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#_4-æµæ°´çº¿ç¤ºä¾‹"><span>4. æµæ°´çº¿ç¤ºä¾‹</span></a></h2><p>ä»¥ä¸‹ç»™å‡ºåŸºäº<code>Dataflow[vllm]</code>ç¯å¢ƒé…ç½®çš„ç¤ºä¾‹æµæ°´çº¿ï¼Œæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨å¤šä¸ªç®—å­è¿›è¡ŒçŸ¥è¯†åº“æ¸…æ´—ã€‚è¯¥ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•åˆå§‹åŒ–ä¸€ä¸ªçŸ¥è¯†åº“æ¸…æ´—æµæ°´çº¿ï¼Œå¹¶ä¸”é¡ºåºæ‰§è¡Œå„ä¸ªæå–å’Œæ¸…ç†æ­¥éª¤ã€‚</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">from</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> dataflow</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">operators</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">knowledge_cleaning </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    KBCChunkGenerator</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    FileOrURLToMarkdownConverterBatch</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    KBCTextCleaner</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # KBCMultiHopQAGenerator,</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">from</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> dataflow</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">operators</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">core_text </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Text2MultiHopQAGenerator</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">from</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> dataflow</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">utils</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> FileStorage</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">from</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> dataflow</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">serving </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> LocalModelLLMServing_vllm</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">class</span><span style="--shiki-light:#2E8F82;--shiki-dark:#5DA994;"> KBCleaning_PDFvllm_GPUPipeline</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">():</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    def</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> __init__</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">):</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> FileStorage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            first_entry_file_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../example_data/KBCleaningPipeline/kbc_test.jsonl</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            cache_path</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">./.cache/gpu</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            file_name_prefix</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">knowledge_cleaning_step_vllm_engine</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            cache_type</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">json</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">knowledge_cleaning_step1 </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> FileOrURLToMarkdownConverterBatch</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            intermediate_dir</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">../../example_data/KBCleaningPipeline/raw/</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            lang</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">en</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            mineru_backend</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">vlm-vllm-engine</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">knowledge_cleaning_step2 </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> KBCChunkGenerator</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            split_method</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">token</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            chunk_size</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">512</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            tokenizer_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Qwen/Qwen2.5-7B-Instruct</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    def</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> forward</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">):</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">knowledge_cleaning_step1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">step</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(),</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">            # input_key=</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">            # output_key=</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        )</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        </span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">knowledge_cleaning_step2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">step</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(),</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">            # input_key=</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">            # output_key=</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">llm_serving </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> LocalModelLLMServing_vllm</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            hf_model_name_or_path</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Qwen/Qwen2.5-7B-Instruct</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            vllm_max_tokens</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">2048</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            vllm_tensor_parallel_size</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">4</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            vllm_gpu_memory_utilization</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0.6</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            vllm_repetition_penalty</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1.2</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">knowledge_cleaning_step3 </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> KBCTextCleaner</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            llm_serving</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">llm_serving</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            lang</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">en</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">knowledge_cleaning_step4 </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Text2MultiHopQAGenerator</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            llm_serving</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">llm_serving</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            lang</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">en</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            num_q</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 5</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">knowledge_cleaning_step3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">step</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(),</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">            # input_key=</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">            # output_key=</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        )</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">knowledge_cleaning_step4</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">step</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(),</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">            # input_key=</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">            # output_key=</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        )</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">if</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> __name__</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> ==</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">__main__</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    model </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> KBCleaning_PDFvllm_GPUPipeline</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    model</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">forward</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,36)]))}const p=i(e,[["render",h]]),d=JSON.parse('{"path":"/zh/guide/kbcpipeline/","title":"çŸ¥è¯†åº“æ¸…æ´—æµæ°´çº¿","lang":"zh-CN","frontmatter":{"title":"çŸ¥è¯†åº“æ¸…æ´—æµæ°´çº¿","icon":"fa6-regular:bookmark","createTime":"2025/06/16 13:08:42","permalink":"/zh/guide/kbcpipeline/"},"readingTime":{"minutes":6.61,"words":1983},"git":{"createdTime":1751690586000,"updatedTime":1760089781000,"contributors":[{"name":"ZhaoyangHan04","username":"ZhaoyangHan04","email":"3319926404@qq.com","commits":11,"avatar":"https://avatars.githubusercontent.com/ZhaoyangHan04?v=4","url":"https://github.com/ZhaoyangHan04"},{"name":"Niujunbo2002","username":"Niujunbo2002","email":"21376334@buaa.edu.cn","commits":1,"avatar":"https://avatars.githubusercontent.com/Niujunbo2002?v=4","url":"https://github.com/Niujunbo2002"}]},"filePathRelative":"zh/notes/guide/pipelines/KnowledgeBaseCleaningPipeline.md","headers":[]}');export{p as comp,d as data};
