import{_ as i,c as a,b as n,o as l}from"./app-GpZKBnvo.js";const t={};function e(h,s){return l(),a("div",null,s[0]||(s[0]=[n(`<p>ç›®å‰Dataflowé›†æˆäº†äº”ç§åŸºç¡€æ–‡æœ¬æ•°æ®åˆæˆå™¨ï¼Œæ¶‰åŠé¢„è®­ç»ƒæ–‡æ¡£æ•°æ®ã€SFTæ ¼å¼æ•°æ®ã€å¤šè½®å¯¹è¯ç­‰ä¸åŒæ ¼å¼ã€‚</p><table class="tg"><thead><tr><th class="tg-0pky">åç§°</th><th class="tg-0pky">é€‚ç”¨ç±»å‹</th><th class="tg-0pky">ç®€ä»‹</th><th class="tg-0pky">å®˜æ–¹ä»“åº“æˆ–è®ºæ–‡</th></tr></thead><tbody><tr><td class="tg-0pky">PretrainGenerator</td><td class="tg-0pky">é¢„è®­ç»ƒ</td><td class="tg-0pky">ä½¿ç”¨é¢„è®­ç»ƒæ–‡æ¡£æ•°æ®åˆæˆç±»phi-4é—®ç­”æ•°æ®å¯¹ï¼Œä½¿ç”¨QAæ ¼å¼å¤è¿°æ–‡æ¡£</td><td class="tg-0pky"><a href="https://arxiv.org/pdf/2401.16380">Paper</a></td></tr><tr><td class="tg-0pky">SFTGeneratorSeed</td><td class="tg-0pky">SFT</td><td class="tg-0pky">æ ¹æ®ç§å­æ–‡æ¡£åˆæˆSFTæ ¼å¼QAæ•°æ®å¯¹ï¼Œå¹¶è¿”å›åŸæ–‡ä¿¡æ¯</td><td class="tg-0pky">-</td></tr><tr><td class="tg-0pky">CondorGenerator</td><td class="tg-0pky">SFT</td><td class="tg-0pky">æ ¹æ®é¢„ç½®çŸ¥è¯†æ ‘æ ‡ç­¾ï¼Œä¸¤é˜¶æ®µä»0åˆæˆSFTæ ¼å¼æ•°æ®ï¼ˆåˆæˆæ•°é‡å¤§äº5000æ—¶å»ºè®®å¢åŠ æ ‡ç­¾æ•°é‡ï¼‰</td><td class="tg-0pky"><a href="https://arxiv.org/abs/2501.12273">paper</a></td></tr><tr><td class="tg-0pky">PromptedGenerator</td><td class="tg-0pky">-</td><td class="tg-0pky">æ ¹æ®ç”¨æˆ·è‡ªå®šä¹‰promptè¿›è¡Œæ•°æ®ç”Ÿæˆ</td><td class="tg-0pky">-</td></tr><tr><td class="tg-0pky">ConsistentChatGenerator</td><td class="tg-0pky">å¤šè½®å¯¹è¯</td><td class="tg-0pky">æ ¹æ®é¢„ç½®ä¸»é¢˜å’Œäººç±»æ„å›¾ï¼Œä¸¤é˜¶æ®µä»0åˆæˆå¤šè½®å¯¹è¯æ ¼å¼æ•°æ®ï¼ˆåˆæˆæ•°é‡å¤§äº9000æ—¶å»ºè®®å¢åŠ æ ‡ç­¾æ•°é‡ï¼‰</td><td class="tg-0pky"><a href="https://arxiv.org/pdf/2506.03558">paper</a></td></tr></tbody></table><h2 id="ç®—å­æ¥å£è°ƒç”¨è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#ç®—å­æ¥å£è°ƒç”¨è¯´æ˜"><span>ç®—å­æ¥å£è°ƒç”¨è¯´æ˜</span></a></h2><p>ç‰¹åˆ«åœ°ï¼Œå¯¹äºæŒ‡å®šå­˜å‚¨è·¯å¾„ç­‰æˆ–æ˜¯è°ƒç”¨æ¨¡å‹çš„ç®—å­ï¼Œæˆ‘ä»¬æä¾›äº†å°è£…åçš„<strong>æ¨¡å‹æ¥å£</strong>ä»¥åŠ<strong>å­˜å‚¨å¯¹è±¡æ¥å£</strong>ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¸ºç®—å­è¿›è¡Œæ¨¡å‹APIå‚æ•°é¢„å®šä¹‰ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">from</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> dataflow</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">llmserving </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> APILLMServing_request</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">api_llm_serving </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> APILLMServing_request</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">                api_url</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">your_api_url</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">                model_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">model_name</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">                max_workers</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">5</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        )</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¸ºç®—å­è¿›è¡Œå­˜å‚¨å‚æ•°é¢„å®šä¹‰ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">from</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> dataflow</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">utils</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> FileStorage</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> FileStorage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            first_entry_file_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">your_file_path</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            cache_path</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">./cache</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            file_name_prefix</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">dataflow_cache_step</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            cache_type</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">jsonl</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # jsonl, json, ...</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        )</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åæ–‡ä½¿ç”¨çš„<code>api_llm_serving</code>ä»¥åŠ<code>self.storage</code>å³ä¸ºæ­¤å¤„å·²å®šä¹‰çš„æ¥å£å¯¹è±¡ï¼Œå®Œæ•´è°ƒç”¨ç¤ºä¾‹å¯å‚è€ƒ<code>test/test_general_text.py</code>ã€‚</p><p>å¯¹äºä¼ å‚ï¼Œç®—å­å¯¹è±¡çš„æ„é€ å‡½æ•°ä¸»è¦ä¼ é€’ä¸ç®—å­é…ç½®ç›¸å…³çš„ä¿¡æ¯ï¼Œé…ç½®åå¯ä»¥ä¸€é…ç½®å¤šè°ƒç”¨ï¼›è€Œ<code>X.run()</code>å‡½æ•°ä¼ é€’ä¸IOç›¸å…³çš„<code>key</code>ä¿¡æ¯ï¼Œè¯¦ç»†å¯è§åæ–‡ç®—å­è¯´æ˜ç¤ºä¾‹ã€‚</p><h2 id="è¯¦ç»†ç®—å­è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#è¯¦ç»†ç®—å­è¯´æ˜"><span>è¯¦ç»†ç®—å­è¯´æ˜</span></a></h2><h3 id="_1-pretraingeneratorâœ¨" tabindex="-1"><a class="header-anchor" href="#_1-pretraingeneratorâœ¨"><span>1. PretrainGeneratorâœ¨</span></a></h3><p><strong>åŠŸèƒ½æè¿°ï¼š</strong> è¯¥ç®—å­ä¸“é—¨ç”¨äºåŸºäºç»™å®šæ–‡æ¡£å†…å®¹ï¼Œç”Ÿæˆé¢„è®­ç»ƒæ ¼å¼çš„å¤šè½®å¯¹è¯é—®ç­”æ•°æ®ã€‚å°†åŸå§‹æ–‡æ¡£å†…å®¹è½¬æ¢ä¸ºé€‚åˆè¯­è¨€æ¨¡å‹é¢„è®­ç»ƒçš„å¯¹è¯æ ¼å¼æ•°æ®ï¼Œé€šè¿‡è°ƒç”¨å¤§è¯­è¨€æ¨¡å‹è¿›è¡Œæ–‡æ¡£å†…å®¹çš„é‡æ–°ç»„ç»‡å’Œè¡¨è¾¾ã€‚</p><p><strong>è¾“å…¥å‚æ•°ï¼š</strong></p><ul><li><code>__init__()</code><ul><li><code>llm_serving</code>ï¼šä½¿ç”¨çš„å¤§è¯­è¨€æ¨¡å‹æ¥å£å¯¹è±¡ï¼ˆå¿…éœ€ï¼Œéœ€å®ç°LLMServingABCæ¥å£ï¼‰</li></ul></li><li><code>run()</code><ul><li><code>storage</code>ï¼šå­˜å‚¨æ¥å£å¯¹è±¡ï¼ˆé»˜è®¤ï¼šå‰æ–‡é¢„è®¾å€¼ï¼‰</li><li><code>input_key</code>ï¼šè¾“å…¥æ–‡æ¡£å†…å®¹å­—æ®µåï¼ˆé»˜è®¤ï¼š&quot;raw_content&quot;ï¼‰</li><li><code>output_key</code>ï¼šè¾“å‡ºç”Ÿæˆå†…å®¹å­—æ®µåï¼ˆé»˜è®¤ï¼š&quot;generated_content&quot;ï¼‰</li></ul></li></ul><p><strong>ä¸»è¦ç‰¹æ€§ï¼š</strong></p><ul><li>æ”¯æŒå¤šç§æ–‡æ¡£æ ¼å¼çš„å†…å®¹è½¬æ¢</li><li>è‡ªåŠ¨ç”Ÿæˆé€‚åˆé¢„è®­ç»ƒçš„å¯¹è¯æ ¼å¼æ•°æ®</li><li>ä¿æŒåŸå§‹æ–‡æ¡£çš„æ ¸å¿ƒä¿¡æ¯å®Œæ•´æ€§</li><li>æ”¯æŒæ‰¹é‡å¤„ç†å¤§è§„æ¨¡æ–‡æ¡£æ•°æ®</li></ul><p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">from</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> dataflow</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">prompts</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">general_text </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> PretrainGeneratorPrompt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">pretrain_gen </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> PretrainGenerator</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">          llm_serving</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">api_llm_serving</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">          )</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">result </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> pretrain_gen</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">          storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">step</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(),</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">          input_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">raw_content</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">          output_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">generated_content</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">          )</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-sftgeneratorseedâœ¨" tabindex="-1"><a class="header-anchor" href="#_2-sftgeneratorseedâœ¨"><span>2. SFTGeneratorSeedâœ¨</span></a></h3><p><strong>åŠŸèƒ½æè¿°ï¼š</strong> è¯¥ç®—å­åŸºäºç»™å®šæ–‡æ¡£å†…å®¹ï¼Œç”Ÿæˆç›‘ç£å¾®è°ƒæ ¼å¼çš„é—®ç­”æ•°æ®ï¼Œå¹¶æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰ç”Ÿæˆå†…å®¹è¦æ±‚ã€‚ä»åŸå§‹æ–‡æ¡£ä¸­æå–ä¿¡æ¯ï¼Œç”Ÿæˆç¬¦åˆSFTæ ¼å¼çš„æŒ‡ä»¤-å“åº”å¯¹ï¼Œç‰¹åˆ«é€‚ç”¨äºæ„å»ºé«˜è´¨é‡çš„ç›‘ç£å¾®è°ƒæ•°æ®é›†ã€‚</p><p><strong>è¾“å…¥å‚æ•°ï¼š</strong></p><ul><li><code>__init__()</code><ul><li><code>llm_serving</code>ï¼šä½¿ç”¨çš„å¤§è¯­è¨€æ¨¡å‹æ¥å£å¯¹è±¡ï¼ˆå¿…éœ€ï¼Œéœ€å®ç°LLMServingABCæ¥å£ï¼‰</li><li><code>custom_prompt</code>ï¼šç”¨æˆ·è‡ªå®šä¹‰æç¤ºè¯ï¼ˆå¿…éœ€ï¼Œå®šä¹‰ç”Ÿæˆå†…å®¹çš„å…·ä½“è¦æ±‚ï¼‰</li></ul></li><li><code>run()</code><ul><li><code>storage</code>ï¼šå­˜å‚¨æ¥å£å¯¹è±¡ï¼ˆé»˜è®¤ï¼šå‰æ–‡é¢„è®¾å€¼ï¼‰</li><li><code>input_key</code>ï¼šè¾“å…¥æ–‡æ¡£å†…å®¹å­—æ®µåï¼ˆé»˜è®¤ï¼š&quot;raw_content&quot;ï¼‰</li></ul></li></ul><p><strong>ä¸»è¦ç‰¹æ€§ï¼š</strong></p><ul><li>æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰ç”Ÿæˆå†…å®¹è¦æ±‚</li><li>è‡ªåŠ¨æå–å’Œè§£æJSONæ ¼å¼çš„æŒ‡ä»¤-å“åº”å¯¹</li><li>ä¿ç•™åŸå§‹æ–‡æ¡£å†…å®¹ç”¨äºè¿½æº¯</li><li>æ™ºèƒ½è¿‡æ»¤æ— æ•ˆç”Ÿæˆç»“æœ</li><li>æ”¯æŒæœ€å¤§4096 tokensçš„é•¿æ–‡æœ¬ç”Ÿæˆ</li></ul><p><strong>è¾“å‡ºæ ¼å¼ï¼š</strong></p><ul><li>åŒ…å«&#39;instruction&#39;ã€&#39;output&#39;å’Œ&#39;raw_content&#39;å­—æ®µçš„DataFrame</li><li>è¿”å›åŒ…å«&#39;instruction&#39;å’Œ&#39;output&#39;å­—æ®µåçš„åˆ—è¡¨</li></ul><p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">from</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> dataflow</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">prompts</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">general_text </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> SFTGeneratorSeedPrompt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">sft_gen </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> SFTGeneratorSeed</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">          llm_serving</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">api_llm_serving</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">          custom_prompt</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">è¯·åŸºäºæ–‡æ¡£å†…å®¹ç”Ÿæˆæ•™å­¦é—®ç­”å¯¹</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">          )</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">result_keys </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> sft_gen</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">          storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">step</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(),</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">          input_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">raw_content</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">          )</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-condorgeneratorâœ¨ğŸš€" tabindex="-1"><a class="header-anchor" href="#_3-condorgeneratorâœ¨ğŸš€"><span>3. CondorGeneratorâœ¨ğŸš€</span></a></h3><p><strong>åŠŸèƒ½æè¿°ï¼š</strong> è¯¥ç®—å­åŸºäºé¢„ç½®çŸ¥è¯†æ ‘æ ‡ç­¾ï¼Œé€šè¿‡ä¸¤é˜¶æ®µæµç¨‹ä»é›¶åˆæˆSFTæ ¼å¼æ•°æ®ã€‚ç¬¬ä¸€é˜¶æ®µæ ¹æ®éšæœºé€‰æ‹©çš„ä¸»é¢˜ã€é¢†åŸŸå’Œä¸»é¢˜æ ‡ç­¾ç”Ÿæˆä¸åŒéš¾åº¦çº§åˆ«ï¼ˆEasyã€Mediumã€Hardï¼‰çš„é—®é¢˜ï¼Œç¬¬äºŒé˜¶æ®µä¸ºæ¯ä¸ªé—®é¢˜ç”Ÿæˆå¯¹åº”çš„è¯¦ç»†ç­”æ¡ˆã€‚</p><p><strong>è¾“å…¥å‚æ•°ï¼š</strong></p><ul><li><code>__init__()</code><ul><li><code>llm_serving</code>ï¼šä½¿ç”¨çš„å¤§è¯­è¨€æ¨¡å‹æ¥å£å¯¹è±¡ï¼ˆå¿…éœ€ï¼Œéœ€å®ç°LLMServingABCæ¥å£ï¼‰</li><li><code>num_samples</code>ï¼šç”Ÿæˆæ ·æœ¬æ€»æ•°ï¼ˆé»˜è®¤ï¼š15ï¼Œå»ºè®®å°äº5000ä»¥ä¿è¯æ•°æ®è´¨é‡ï¼‰</li></ul></li><li><code>run()</code><ul><li><code>storage</code>ï¼šå­˜å‚¨æ¥å£å¯¹è±¡ï¼ˆé»˜è®¤ï¼šå‰æ–‡é¢„è®¾å€¼ï¼‰</li></ul></li></ul><p><strong>ä¸»è¦ç‰¹æ€§ï¼š</strong></p><ul><li>ä¸¤é˜¶æ®µç”Ÿæˆæµç¨‹ç¡®ä¿é—®ç­”è´¨é‡</li><li>æ”¯æŒä¸‰ä¸ªéš¾åº¦çº§åˆ«çš„é—®é¢˜ç”Ÿæˆ</li><li>åŸºäºé¢„ç½®çŸ¥è¯†æ ‘æ ‡ç­¾ä¿è¯å†…å®¹å¤šæ ·æ€§</li><li>è‡ªåŠ¨è§£æå’Œæ ¼å¼åŒ–ç”Ÿæˆç»“æœ</li><li>æ™ºèƒ½é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•</li></ul><p><strong>ç”Ÿæˆæµç¨‹ï¼š</strong></p><ol><li><strong>é—®é¢˜ç”Ÿæˆé˜¶æ®µ</strong>ï¼šæ ¹æ®éšæœºé€‰æ‹©çš„topicã€domainã€themeç”Ÿæˆä¸‰ä¸ªéš¾åº¦çº§åˆ«çš„é—®é¢˜</li><li><strong>ç­”æ¡ˆç”Ÿæˆé˜¶æ®µ</strong>ï¼šä¸ºæ¯ä¸ªæœ‰æ•ˆé—®é¢˜ç”Ÿæˆå¯¹åº”çš„è¯¦ç»†ç­”æ¡ˆ</li><li><strong>æ•°æ®æ•´ç†é˜¶æ®µ</strong>ï¼šå°†é—®é¢˜å’Œç­”æ¡ˆç»„ç»‡æˆæ ‡å‡†SFTæ ¼å¼</li></ol><p><strong>è¾“å‡ºæ ¼å¼ï¼š</strong></p><ul><li>åŒ…å«&#39;difficulty&#39;ã€&#39;instruction&#39;å’Œ&#39;output&#39;å­—æ®µçš„DataFrame</li><li>difficultyå­—æ®µæ ‡è¯†é—®é¢˜éš¾åº¦çº§åˆ«ï¼ˆEasy/Medium/Hardï¼‰</li></ul><p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">from</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> dataflow</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">prompts</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">general_text </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> CondorPrompt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">condor_gen </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> CondorGenerator</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">          llm_serving</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">api_llm_serving</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">          num_samples</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">150</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # å°†ç”Ÿæˆçº¦150ä¸ªé—®ç­”å¯¹</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">          )</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">result_df </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> condor_gen</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">          storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">step</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">          )</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ³¨æ„äº‹é¡¹ï¼š</strong></p><ul><li>å½“ç”Ÿæˆæ•°é‡å¤§äº5000æ—¶ï¼Œå»ºè®®åœ¨<code>dataflow.prompts.general_text.CondorPrompt</code>ä¸­å¢åŠ æ ‡ç­¾æ•°é‡ä»¥æé«˜æ•°æ®ä¸°å¯Œæ€§</li><li>ç®—å­ä¼šè‡ªåŠ¨å¤„ç†è§£æå¤±è´¥çš„å“åº”ï¼Œç¡®ä¿è¾“å‡ºæ•°æ®çš„æœ‰æ•ˆæ€§</li></ul><h3 id="_4-promptedgeneratorâœ¨" tabindex="-1"><a class="header-anchor" href="#_4-promptedgeneratorâœ¨"><span>4. PromptedGeneratorâœ¨</span></a></h3><p><strong>åŠŸèƒ½æè¿°ï¼š</strong> è¯¥ç®—å­åŸºäºç”¨æˆ·æä¾›çš„æç¤ºè¯ï¼ˆpromptï¼‰ç”Ÿæˆæ•°æ®ï¼Œç»“åˆç³»ç»Ÿæç¤ºè¯å’Œè¾“å…¥å†…å®¹ç”Ÿæˆç¬¦åˆè¦æ±‚çš„è¾“å‡ºæ–‡æœ¬ã€‚æä¾›äº†æœ€å¤§çš„çµæ´»æ€§ï¼Œå…è®¸ç”¨æˆ·å®Œå…¨è‡ªå®šä¹‰ç”Ÿæˆé€»è¾‘å’Œè¾“å‡ºæ ¼å¼ã€‚</p><p><strong>è¾“å…¥å‚æ•°ï¼š</strong></p><ul><li><code>__init__()</code><ul><li><code>llm_serving</code>ï¼šä½¿ç”¨çš„å¤§è¯­è¨€æ¨¡å‹æ¥å£å¯¹è±¡ï¼ˆå¿…éœ€ï¼Œéœ€å®ç°LLMServingABCæ¥å£ï¼‰</li><li><code>system_prompt</code>ï¼šç³»ç»Ÿæç¤ºè¯ï¼Œå®šä¹‰æ¨¡å‹è¡Œä¸ºï¼ˆé»˜è®¤ï¼š&quot;You are a helpful agent.&quot;ï¼‰</li></ul></li><li><code>run()</code><ul><li><code>storage</code>ï¼šå­˜å‚¨æ¥å£å¯¹è±¡ï¼ˆé»˜è®¤ï¼šå‰æ–‡é¢„è®¾å€¼ï¼‰</li><li><code>input_key</code>ï¼šè¾“å…¥å†…å®¹å­—æ®µåï¼ˆé»˜è®¤ï¼š&quot;raw_content&quot;ï¼‰</li><li><code>output_key</code>ï¼šè¾“å‡ºç”Ÿæˆå†…å®¹å­—æ®µåï¼ˆé»˜è®¤ï¼š&quot;generated_content&quot;ï¼‰</li></ul></li></ul><p><strong>ä¸»è¦ç‰¹æ€§ï¼š</strong></p><ul><li>å®Œå…¨è‡ªå®šä¹‰çš„æç¤ºè¯æ§åˆ¶</li><li>çµæ´»çš„è¾“å…¥è¾“å‡ºå­—æ®µé…ç½®</li><li>æ”¯æŒä»»æ„æ ¼å¼çš„æ–‡æœ¬ç”Ÿæˆä»»åŠ¡</li><li>ç®€å•ç›´æ¥çš„ç³»ç»Ÿæç¤ºè¯ä¸è¾“å…¥å†…å®¹ç»„åˆ</li><li>æ‰¹é‡å¤„ç†èƒ½åŠ›</li></ul><p><strong>å·¥ä½œåŸç†ï¼š</strong></p><ol><li>å°†ç³»ç»Ÿæç¤ºè¯ä¸è¾“å…¥å†…å®¹ç›´æ¥æ‹¼æ¥</li><li>è°ƒç”¨LLMç”Ÿæˆå¯¹åº”çš„è¾“å‡ºå†…å®¹</li><li>å°†ç”Ÿæˆç»“æœæ·»åŠ åˆ°æŒ‡å®šçš„è¾“å‡ºå­—æ®µ</li></ol><p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">prompted_gen </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> PromptedGenerator</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">          llm_serving</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">api_llm_serving</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">          system_prompt</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ–‡æ¡£æ‘˜è¦ç”Ÿæˆå™¨ï¼Œè¯·ä¸ºä»¥ä¸‹å†…å®¹ç”Ÿæˆç®€æ´çš„æ‘˜è¦ï¼š</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">          )</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">result_key </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> prompted_gen</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">          storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">step</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(),</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">          input_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">raw_content</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">          output_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">summary</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">          )</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-consistentchatgenerator-âœ¨" tabindex="-1"><a class="header-anchor" href="#_5-consistentchatgenerator-âœ¨"><span>5. ConsistentChatGenerator âœ¨</span></a></h3><p><strong>åŠŸèƒ½æè¿°ï¼š</strong><br> è¯¥ç®—å­åŸºäºé¢„ç½®ä¸»é¢˜å’Œäººç±»æ„å›¾ï¼Œé€šè¿‡ä¸¤é˜¶æ®µæµç¨‹ä»é›¶åˆæˆå¤šè½®å¯¹è¯æ ¼å¼æ•°æ®ã€‚ç¬¬ä¸€é˜¶æ®µç”Ÿæˆç‰¹å®šä¸»é¢˜å’Œæ„å›¾ä¸‹çš„å¤šè½®ç”¨æˆ·æé—®ï¼Œç¬¬äºŒé˜¶æ®µä¸ºæ¯è½®é—®é¢˜ç”Ÿæˆå¯¹åº”å›å¤ã€‚é€‚ç”¨äºæ„å»ºä¸€è‡´æ€§å¼ºã€ç±»åˆ«æ˜ç¡®çš„å¤§è§„æ¨¡å¯¹è¯è¯­æ–™ã€‚</p><p><strong>è¾“å…¥å‚æ•°ï¼š</strong></p><ul><li><p><code>__init__()</code></p><ul><li><code>llm_serving</code>ï¼šä½¿ç”¨çš„å¤§è¯­è¨€æ¨¡å‹æ¥å£å¯¹è±¡ï¼ˆå¿…éœ€ï¼Œéœ€å®ç° LLMServingABC æ¥å£ï¼‰</li><li><code>num_dialogs_per_intent</code>ï¼šæ¯ä¸ªæ„å›¾ç”Ÿæˆçš„å¯¹è¯æ•°é‡ï¼ˆé»˜è®¤ï¼š20ï¼Œå»ºè®®ä¸è¶…è¿‡1000ï¼‰</li><li><code>num_turns_per_dialog</code>ï¼šæ¯ä¸ªå¯¹è¯åŒ…å«çš„è½®æ¬¡æ•°é‡ï¼ˆé»˜è®¤ï¼š6ï¼‰</li><li><code>temperature</code>ï¼šç”Ÿæˆæ¸©åº¦ï¼Œæ§åˆ¶é‡‡æ ·éšæœºæ€§ï¼ˆé»˜è®¤ï¼š0.9ï¼‰</li></ul></li><li><p><code>run()</code></p><ul><li><code>storage</code>ï¼šå­˜å‚¨æ¥å£å¯¹è±¡ï¼ˆé»˜è®¤ï¼šå‰æ–‡é¢„è®¾å€¼ï¼‰</li></ul></li></ul><p><strong>ä¸»è¦ç‰¹æ€§ï¼š</strong></p><ul><li>é¢„ç½®ä¸»é¢˜ä¸æ„å›¾ç»„åˆï¼Œè¦†ç›–å¤šé¢†åŸŸåœºæ™¯</li><li>ä¸¤é˜¶æ®µç”Ÿæˆï¼šå…ˆç”Ÿæˆç”¨æˆ·é—®é¢˜ï¼Œå†ç”Ÿæˆå¯¹åº”å›ç­”</li><li>è‡ªåŠ¨æ¸…æ´—æ ¼å¼é”™è¯¯åŠæ— æ•ˆç»“æœ</li><li>æ”¯æŒå¤§è§„æ¨¡æ‰¹é‡åˆæˆï¼ˆæ¨èæ•°é‡ &lt; 9000ï¼Œè¶…è¿‡å»ºè®®æ‰©å±•ä¸»é¢˜æ ‡ç­¾ï¼‰</li><li>ç”Ÿæˆæ ‡å‡†çš„å¤šè½®å¯¹è¯æ ¼å¼ï¼Œé€‚é…å¸¸è§ SFT è®­ç»ƒä»»åŠ¡</li></ul><p><strong>è¾“å‡ºæ ¼å¼ï¼š</strong></p><ul><li>åŒ…å« <code>category</code> å’Œ <code>conversation</code> å­—æ®µçš„ DataFrame</li><li><code>conversation</code> å­—æ®µä¸ºå¤šè½®é—®ç­”ç»„æˆçš„å¯¹è¯åˆ—è¡¨ï¼Œæ¯è½®å¯¹è¯ç»“æ„ä¸ºï¼š<div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  {</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">role</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">user</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;"> &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">value</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">é—®é¢˜</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">},</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  {</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">role</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">assistant</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;"> &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">value</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">å›ç­”</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">},</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">  ...</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">from</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> dataflow</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">operators</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">general_text </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ConsistentChatGenerator</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">consistent_gen </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ConsistentChatGenerator</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    llm_serving</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">api_llm_serving</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    num_dialogs_per_intent</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">30</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    num_turns_per_dialog</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">4</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    temperature</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0.85</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">result_df </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> consistent_gen</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">step</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ³¨æ„äº‹é¡¹ï¼š</strong></p><p>å½“åˆæˆå¯¹è¯çš„æ•°é‡è¶…è¿‡ 9000 æ¡æ—¶ï¼Œå»ºè®®åœ¨ ConsistentChatPrompt ä¸­æ‰©å±• topic_dictï¼Œä»¥æå‡ç”Ÿæˆå¯¹è¯çš„å¤šæ ·æ€§å’Œè¦†ç›–èŒƒå›´ã€‚ä¸ºäº†ä¿è¯è¾“å‡ºæ•°æ®çš„è´¨é‡ï¼Œç®—å­ä¼šè‡ªåŠ¨è·³è¿‡æ ¼å¼ä¸åˆè§„æˆ–æ— æ³•è§£æçš„ç”Ÿæˆç»“æœï¼Œç¡®ä¿æœ€ç»ˆå¾—åˆ°çš„å¯¹è¯ç»“æ„æ¸…æ™°ã€å†…å®¹åˆç†ã€‚åœ¨ç”Ÿæˆå¤šè½®å¯¹è¯çš„è¿‡ç¨‹ä¸­ï¼Œè¯¥ç®—å­ä¼šå¯¹æ¯æ¡å¯¹è¯è°ƒç”¨ä¸¤æ¬¡ LLM æ¥å£ï¼ˆä¸€æ¬¡ç”Ÿæˆç”¨æˆ·æé—®ï¼Œä¸€æ¬¡ç”ŸæˆåŠ©æ‰‹å›ç­”ï¼‰ï¼Œå› æ­¤éœ€è¦ç¡®ä¿æ‰€ä½¿ç”¨çš„ LLM æœåŠ¡ç¨³å®šã€å“åº”è¿…é€Ÿã€‚</p>`,64)]))}const p=i(t,[["render",e]]),r=JSON.parse('{"path":"/zh/guide/lo3cyadt/","title":"é€šç”¨æ–‡æœ¬æ•°æ®åˆæˆç®—å­","lang":"zh-CN","frontmatter":{"title":"é€šç”¨æ–‡æœ¬æ•°æ®åˆæˆç®—å­","createTime":"2025/06/24 21:49:55","permalink":"/zh/guide/lo3cyadt/"},"readingTime":{"minutes":7.88,"words":2365},"git":{"createdTime":1750777722000,"updatedTime":1753160455000,"contributors":[{"name":"Hao Liang","username":"","email":"hao.liang@stu.pku.edu.cn","commits":1,"avatar":"https://gravatar.com/avatar/105bae3e8661728b9f2f5440992b04f5f28459b66a049d09b52213ce1438f6bc?d=retro"},{"name":"zzy1127","username":"zzy1127","email":"1726073424@qq.com","commits":3,"avatar":"https://avatars.githubusercontent.com/zzy1127?v=4","url":"https://github.com/zzy1127"},{"name":"wongzhenhao","username":"wongzhenhao","email":"zhenhao1141@gmail.com","commits":2,"avatar":"https://avatars.githubusercontent.com/wongzhenhao?v=4","url":"https://github.com/wongzhenhao"}]},"filePathRelative":"zh/notes/guide/general_operators/text_generate_operators.md","headers":[]}');export{p as comp,r as data};
